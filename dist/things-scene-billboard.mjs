import{HTMLOverlayContainer,ScriptLoader,error,Component}from"@hatiolab/things-scene";const NATURE={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"textarea",label:"config",name:"config"}]};class Billboard extends HTMLOverlayContainer{oncreate_element(t){this._anchor=document.createElement("div"),this._anchor.style.width="100%",this._anchor.style.height="100%",this.element.appendChild(this._anchor),ScriptLoader.load(["https://d3js.org/d3.v4.min.js","https://naver.github.io/billboard.js/release/latest/dist/billboard.min.js"],["https://naver.github.io/billboard.js/release/latest/dist/billboard.min.css"]).then(()=>{requestAnimationFrame(()=>{this.chart=bb.generate({bindto:this._anchor,data:Object.assign({},this.config,{columns:this.data})}),this.reposition()})},error)}dispose(){this.chart&&this.chart.destroy(),delete this.chart,delete this._anchor,super.dispose()}setElementProperties(t){}reposition(){super.reposition(),this.chart&&this.chart.load({columns:this.data})}get config(){var{config:config,data:data}=this.state;if("object"!=typeof config)try{eval(`config = ${config}`)}catch(t){error(t)}return config}get tagName(){return"div"}get nature(){return NATURE}}Component.register("billboard",Billboard);export{Billboard};
